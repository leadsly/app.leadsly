<ng-container *ngIf="_showTwoFactorAuthSetupWizard === false; else twoFactorAuthenticationSetupWizard">
	<div class="two-factor-settings">
		<h3>{{ 'odm.account.security.two-step.title' | translate }}</h3>
		<ng-container *ngIf="!loading; else loadingState">
			<div [ngClass]="twoFactorEnabled ? 'two-factor-settings__extra-margin' : null" class="two-factor-settings__state" @downUpFadeIn>
				<div class="two-factor-settings__short-description">
					<span>{{ 'odm.account.security.two-step.description' | translate }}</span>
				</div>
				<div class="two-factor-settings__toggle-state" @downUpFadeIn>
					<div class="two-factor-settings__toggle-state-spinner-container">
						<ng-container *ngIf="_twoFactorAuthToggleLoading">
							<odm-spinner [type]="'button'" [diameter]="_twoFactorAuthToggleSpinnerDiameter" [strokeWidth]="_twoFactorAuthToggleSpinnerStrokeWidth">
							</odm-spinner>
						</ng-container>
					</div>
					<mat-slide-toggle
						#slideToggle
						[disabled]="_twoFactorAuthToggleLoading"
						[checked]="twoFactorEnabled"
						(change)="_onTwoFactorAuthToggleChanged($event)"
						color="primary"
					></mat-slide-toggle>
				</div>
			</div>
			<ng-container *ngIf="twoFactorEnabled">
				<div @downUpFadeIn>
					<div class="two-factor-settings__user-recovery-codes">
						<odm-two-factor-authentication-codes
							[codes]="userRecoveryCodes"
							[disabled]="_twoFactorAuthToggleLoading"
							[generatingCodes]="generatingNewRecoveryCodes"
							[serverError]="_serverError$ | async"
							(generateNewRecoveryCodesClicked)="_onGenerateNew2FaRecoveryCodesClicked()"
							(userCodesPanelClosed)="_onUserCodesPanelClosed()"
							(userCodesPanelOpened)="_onUserRecoveryCodesOpened()"
						>
						</odm-two-factor-authentication-codes>
					</div>
				</div>
			</ng-container>
		</ng-container>
	</div>
</ng-container>

<ng-template #twoFactorAuthenticationSetupWizard>
	<odm-two-factor-authentication-setup-wizard
		[verificationCodeForm]="verificationCodeForm"
		[twoFactorAuthenticationSetupResult]="authenticatorSetupResult"
		[twoFactorAuthenticationSetup]="_authenticatorSetup"
		[problemDetails]="_problemDetails$ | async"
		[internalServerErrorDetails]="_internalServerErrorDetails$ | async"
		[codeVerificationInProgress]="codeVerificationInProgress"
		(verificationCodeSubmitted)="_onVerifyAuthenticatorSubmitted($event)"
		(cancelSetupWizardClicked)="_onCancelSetupWizardClicked()"
		(finish2faSetupClicked)="_onFinish2faSetupClicked($event)"
	></odm-two-factor-authentication-setup-wizard>
</ng-template>

<ng-template #loadingState>
	<div class="two-factor-settings__ghost-loading-state">
		<odm-ghost-block></odm-ghost-block>
	</div>
	<div class="two-factor-settings__ghost-loading-codes">
		<odm-ghost-block></odm-ghost-block>
	</div>
</ng-template>
