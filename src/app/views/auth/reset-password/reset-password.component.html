<div>
	<form [formGroup]="_resetPasswordForm" (ngSubmit)="_onSubmit()" role="form" novalidate>
		<h3>{{ 'odm.auth.sign-up.title' | translate }}</h3>
		<div>
			<mat-form-field appearance="standard">
				<mat-label>{{ 'odm.auth.form.label.email' | translate }}</mat-label>
				<input formControlName="email" matInput placeholder="example@gmail.com" type="email" autocomplete="email" required />
				<mat-hint>
					<ng-container *ngIf="_resetPasswordFormEmailControlStatusChanges$ | async as status">
						<span *ngIf="status === 'PENDING' && !_internalServerErrorOccured" class="check-availability-animation"
							>{{ 'odm.auth.checking-availability' | translate }}<span>.</span><span>.</span><span>.</span>
						</span>
						<span *ngIf="status === 'VALID'">
							<mat-icon class="req-met" matPrefix>{{ 'task_alt' }}</mat-icon>
							{{ 'odm.auth.form.validations.valid-email' | translate }}
						</span>
						<!--
              https://stackoverflow.com/a/63537759/7952244
              <mat-error> content is only displayed when control is touched or when form is submitted.
              The logic flow goes as follow:
              1. onBlur perform async validation and check if entered email already exists.
              2. Check if any server side errors occured:
                OnTrue: mark the control as pristine and display the error. Marking email control
                        as pristine will circumvent angular's logic of displaying mat-error.
                        Marking control as pristine ensure's that error message is displayed
                        until user starts changing values inside the email control field.
              -->
						<span *ngIf="_ifControlFieldIsInvalid(_resetPasswordForm?.get('email'), 'email')">
							<mat-icon class="auth--req-not-met" matPrefix>{{ 'clear' }}</mat-icon>
							{{ _getErrorMessage$(_resetPasswordForm?.get('email')) | async }}
						</span>
					</ng-container>
				</mat-hint>
				<mat-icon matSuffix>email</mat-icon>
				<mat-error *ngIf="_ifControlFieldIsInvalid(_resetPasswordForm?.get('email'), 'email')">{{
					_getErrorMessage$(_resetPasswordForm?.get('email')) | async
				}}</mat-error>
			</mat-form-field>
		</div>

		<div class="password-field">
			<mat-form-field appearance="standard">
				<mat-label>{{ 'odm.auth.form.label.password' | translate }}</mat-label>
				<input matInput formControlName="password" [type]="_hide ? 'password' : 'text'" autocomplete="new-password" required />
				<mat-icon class="view-password" matSuffix (click)="_hide = !_hide">{{ _hide ? 'visibility_off' : 'visibility' }}</mat-icon>
				<mat-hint>
					<span>
						<ng-container *ngIf="!_resetPasswordForm?.get('password').pristine">
							<mat-icon [ngClass]="_passwordLengthReqMet ? 'req-met' : 'req-not-met'" matPrefix>{{
								_passwordLengthReqMet ? 'task_alt' : 'clear'
							}}</mat-icon>
						</ng-container>
						{{ 'odm.auth.form.requirements.min-chars-long' | translate }}
					</span>
					<br />
					<span>
						<ng-container *ngIf="!_resetPasswordForm?.get('password').pristine">
							<mat-icon [ngClass]="_passwordUppercaseReqMet ? 'req-met' : 'req-not-met'" matPrefix>{{
								_passwordUppercaseReqMet ? 'task_alt' : 'clear'
							}}</mat-icon>
						</ng-container>
						{{ 'odm.auth.form.requirements.one-upper-case' | translate }}
					</span>
					<br />
					<span>
						<ng-container *ngIf="!_resetPasswordForm?.get('password').pristine">
							<mat-icon [ngClass]="_passwordLowercaseReqMet ? 'req-met' : 'req-not-met'" matPrefix>{{
								_passwordLowercaseReqMet ? 'task_alt' : 'clear'
							}}</mat-icon>
						</ng-container>
						{{ 'odm.auth.form.requirements.one-lower-case' | translate }}
					</span>
					<br />
					<span>
						<ng-container *ngIf="!_resetPasswordForm?.get('password').pristine">
							<mat-icon [ngClass]="_passwordDigitReqMet ? 'req-met' : 'req-not-met'" matPrefix>{{
								_passwordDigitReqMet ? 'task_alt' : 'clear'
							}}</mat-icon>
						</ng-container>
						{{ 'odm.auth.form.requirements.digit' | translate }}
					</span>
					<br />
					<span>
						<ng-container *ngIf="!_resetPasswordForm?.get('password').pristine">
							<mat-icon [ngClass]="_passwordThreeUniqueCharacterCountReqMet ? 'req-met' : 'req-not-met'" matPrefix>{{
								_passwordThreeUniqueCharacterCountReqMet ? 'task_alt' : 'clear'
							}}</mat-icon>
						</ng-container>
						{{ 'odm.auth.form.requirements.three-unique-chars' | translate }}
					</span>
					<br />
					<span>
						<ng-container *ngIf="!_resetPasswordForm?.get('password').pristine">
							<mat-icon [ngClass]="_passwordSpecialCharacterReqMet ? 'req-met' : 'req-not-met'" matPrefix>{{
								_passwordSpecialCharacterReqMet ? 'task_alt' : 'clear'
							}}</mat-icon>
						</ng-container>
						{{ 'odm.auth.form.requirements.one-special-char' | translate }}
					</span>
				</mat-hint>
				<mat-error *ngIf="_ifServerErrorOccured(_resetPasswordForm?.get('password'), 'password')">{{
					_getErrorMessage$(_resetPasswordForm?.get('password')) | async
				}}</mat-error>
			</mat-form-field>
		</div>

		<div>
			<mat-form-field appearance="standard">
				<mat-label>{{ 'odm.auth.form.label.confirm-password' | translate }}</mat-label>
				<input matInput formControlName="confirmPassword" [type]="_hide ? 'password' : 'text'" autocomplete="new-password" />
				<mat-icon class="view-password" matSuffix (click)="_hide = !_hide">{{ _hide ? 'visibility_off' : 'visibility' }}</mat-icon>
				<mat-hint>
					<span>
						<ng-container *ngIf="!_resetPasswordForm?.get('confirmPassword').pristine && _resetPasswordForm?.get('password').valid">
							<mat-icon [ngClass]="_confirmPasswordNotMatchReqMet ? 'req-met' : 'req-not-met'" matPrefix>{{
								_confirmPasswordNotMatchReqMet ? 'task_alt' : 'clear'
							}}</mat-icon>
						</ng-container>
						{{ 'odm.auth.form.requirements.pass-must-match' | translate }}
					</span>
				</mat-hint>
				<mat-error *ngIf="_resetPasswordForm?.get('confirmPassword').invalid">{{
					_getErrorMessage$(_resetPasswordForm?.get('confirmPassword')) | async
				}}</mat-error>
			</mat-form-field>
		</div>

		<div>
			<button mat-raised-button type="submit" class="btn signup-btn" [disabled]="!_resetPasswordForm?.valid">
				{{ 'odm.buttons.reset-password' | translate }}
			</button>
		</div>
	</form>
</div>
